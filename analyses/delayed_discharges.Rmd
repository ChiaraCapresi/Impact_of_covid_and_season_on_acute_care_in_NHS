---
title: "R Notebook"
output: html_notebook
---

```{r}
library(tidyverse)
library(lubridate)
library(janitor)
```


```{r}
delayed <- clean_names(read_csv("delayed-discharge-beddays-health-board.csv"))
```

Initial clean:  not interested in delay reasons,
                remove qualifier rows

```{r}
delayed <- delayed %>% 
  filter(reason_for_delay == "All Delay Reasons") %>% 
  select(month_of_delay,
         hbt,
         age_group,
         number_of_delayed_bed_days,
         average_daily_number_of_delayed_beds)
```


```{r}
delayed <- delayed %>% 
  mutate(month_of_delay = ym(month_of_delay))
```



#### Inspecting the difference over health boards (all ages)

```{r}
delayed %>% 
  filter(age_group == "18plus") %>% 
  ggplot() +
  aes(x = month_of_delay,
      y = average_daily_number_of_delayed_beds,
      group = hbt, colour = hbt) +
  geom_line()
```



Removing outlier to get a better impression of how the health boards compare

```{r}
delayed %>% 
  slice_max(average_daily_number_of_delayed_beds, n = 1)
```


```{r}
delayed %>% 
  filter(age_group == "18plus",
         hbt != "S92000003") %>% 
  ggplot() +
  aes(x = month_of_delay,
      y = average_daily_number_of_delayed_beds,
      group = hbt, colour = hbt) +
  geom_line()
```

most readable graph of the year winner 2023

would be interesting to be able to look at individual health boards reactively as they seem to have
drastically different patterns to one another





#### Difference between age groups

example of difference in ages for single health board

```{r}
delayed %>% 
  filter(age_group != "18plus",
         hbt == "S08000015") %>% 
  ggplot() +
  aes(x = month_of_delay,
      y = average_daily_number_of_delayed_beds,
      group = age_group, colour = age_group) +
  geom_line()
```


not super interesting, only shows the difference, maybe a line of changing proportion would be more
descriptive

```{r}
delayed %>% 
  filter(age_group != "18plus") %>% 
  
```



